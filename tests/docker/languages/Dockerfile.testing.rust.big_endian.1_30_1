FROM rust:1.30.1-slim-stretch as base

WORKDIR /setup
RUN curl https://sh.rustup.rs > rustup.sh
RUN cat rustup.sh | sh -s -- --default-toolchain none

WORKDIR /code
ADD . .
RUN cp flatc_debian_stretch flatc
WORKDIR /code/tests/rust_usage_test
RUN cargo build --target mips-unknown-linux-gnu
